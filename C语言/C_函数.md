# cC_函数

## 动态的存储方式与静态的存储方式

- 所谓的静态存储方式是指在程序运行期间由系统分配固定的存储空间的方式
- 而动态的存储方式则是在程序的运行期间根据需要进行动态的分配存储空间的方式

用户存储空间可以分为三部分：

1. 程序区
2. 静态存储区   （全局变量）
3. 动态存储区 （局部变量）

## 变量存储类别

- 在c语言中每一个变量和函数有两个属性：数据类型和数据的存储类别
- 数据类型（如整型，字符型）。存储类别指的是数据在内存中的存储方式
- 存储方式分两大类：静态存储类和动态存储类
- 具体包含四种：自动的（auto）,静态的（Static），寄存器的（register），外部的（extern）.根据变量的存储类别，可以知道**变量的作用域和生存期**

**auto变量**：函数中的局部变量，如不专门的声明为Static存储类别，都是动态地分配存储空间的（栈），数据存储在动态存储区中。

函数中形参和在函数中定义的变量（包括在复合语句中定义的变量），都是此类型，**在调用该函数时系统会给他们分配存储空间**，在函数调用结束就自动释放这些存储空间。



## static声明局部变量（静态局部变量）

有时希望函数中的局部变量的值在函数调用结束后不消失而保留原值，即其占有的存储单元不释放，在下一次该函数调用时，该变量已有值，就是上一次函数调用结束时的值。

这个时候用static声明就可以了



- 静态局部变量属于静态存储类别，在静态存储区内分配存储单元。**在程序整个运行期间都不释放**；
- 对静态局部变量是在编译时赋初值的，即只赋初值一次，在程序运行时它已有初值。以后每次调用的时候都不重新的赋初值而是保留上次函数调用结束时的值
- 如在定义局部变量不赋初值的话，则对**静态局部变量**来说，编译时自动赋初值0（对数值类型变量）或者是空字符（对字符型变量）
- 如在定义局部变量不赋初值的话，**对自动变量来说，**如果不赋初值则它的值是一个不确定的值，这是因为每次函数调用之后存储单元已经释放，下次调用时又重新另分配存储单元，而所分配的存储单元中的值是不确定的。
- 虽然静态局部变量在函数调用结束后任然存在，但其他函数是不能引用它的，因为它是静态的



## static声明外部变量

有时在程序设计中希望某些外部变量值**限于本文件引用，而不能被其他文件引用**。这时可以在定义外部变量时加一个static声明







## register变量

一般情况下，变量（包括静态存储方式和动态存储方式）的值是存放在内存中的

由于对寄存器的存取速度远高于对内存的存取速度，因此这样做可以提高效率，这种寄存器变量，用关键字register作声明

## extern声明外部变量

**外部变量即使全局变量**，它的作用域是从变量的定义处开始，到本程序文件的结尾。

在此作用域内，**全局变量可以为程序中各个函数所引用**。编译时将外部变量**分配在静态存储区**。也就是说全局变量和static变量放在同一个地方的



- 有时使用extern声明外部变量，扩展局部变量的作用域



## 在多个文件的程序中声明外部变量

file1.c

```c
#include <stdio.h>

int A //全局变量
void main(){
  
  int power(int) //声明hans
  int b=3,c,d,m;
  
  printf("enter the number A and its power m:\n");
  scanf("%d %d",&A,&m);
  
  c=A*b;
  printf("%d *%d = %d \n",A,m,c);
  
  d=power(m);
  printf("%d ^ %d=%d\n",A,m,d);
}
```

file2.c

```c
extern A  //声明A为一个已经定义的外部变量
 int power(int n){
   int i,y=1;
  for(i=1;i <=n;i++){
    y *=A;
  }
  return y
 }
```


## 关于变量的声明和定义

- 对于变量而言，声明与定义的关系稍微的复杂一些，在声明部分出现的变量有两种情况：一种是需要建立存储空间的（如int a;），另外的一种是不需要建立存储空间的（extern  a;）
- 前者是定义性声明，后者是引用性声明
- 声明只是说有这么的一个东西存在