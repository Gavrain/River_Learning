

# 改进的个性化地点推荐算法

LBSN 的地点推荐中，影响地点推荐准确性的因素有：
1）用户偏好：用户对某地点的兴趣程度可根据用户对该地点的签到次数来判断。
用户签到次数越多，兴趣程度越高。
2）社交网络中的信任关系：相比于根据相似匿名用户的在线系统的推荐，人们更
倾向于依赖他们信任的朋友的推荐。
3）地理位置的影响：用户对地点的签到记录中，用户的签到行为会呈现出地域集
中的情况。

在传统推荐利用用户偏好的基础上，强化地点推荐中地点信息和社交信息的影响作用，提出本文的推荐方法。本章 4.1 节介绍了针对地点特性提出的基于地点的协同过滤算法，4.2 节详细介绍了融合社交因素和位置因素的地点推荐算法。

###基于地点的协同过滤推荐 PB-CF

与基于物品的协同过滤推荐算法如出一辙，基于地点的协同过滤推荐算法以地点为数据处理的中心。然而，地点作为推荐的对象，与物品相比增加了一个重要的信息，即地理位置信息。所以在基于位置的社交网络中进行地点推荐时仅依靠传统的基于物品的协同过滤算法未充分利用数据信息，造成推荐的不准确。**为此，提出了一种基于地点的协同过滤算法**（Place-based Collaborating Filtering，PB-CF），在计算地点相似度的同时，计算地点类型的相似度，并融合地点的地理位置的影响，以达到改善推荐效果的目的。

####计算地点签到相似度

　　位置社交网络平台提供大量的数据信息，其中，应用到推荐中必不可缺的是用户的历史签到记录，换句话说，等同于地点的被签到记录，通过分析地点的被签到记录，找出地点之间的相似性，在这里称为地点签到相似度。其基本原理是如果**某些地点同时被几个或者许多用户签到过，那么这些地点之间存在着某些隐性的联系**，可以认为这些地点之间存在某种相似性，可能是地点类型的相似，也可能是位置信息的相似。所以计算地点签到相似度找出地点之间的隐性关系尤为重要。

　　具体的计算方法同基于用户的协同过滤推荐中计算用户相似度的方法类似，将用户的签到记录转换为地点的被签到记录，如表 4-1 中给出地点的被签到情况，地点集合L={a,b,c,d}，用户集合 U={A,B,C,D}
。表中数值 0 表示该地点被对用的用户签到，数值1 表示没有签到记录。

![1542679077966](../../../../../AppData/Roaming/Typora/typora-user-images/1542679077966.png)

计算地点签到相似度采用的方法仍然为余弦相似度，前文已经对余弦相似度详细说
明，这里不再赘述，计算出地点 $l_i$ 和 $l_j$ 的相似度 $Csim(l_i,l_j)$。

$S_{uv}=\frac{\sum_{i∈L_{uv}}r_{ui}r_{vi}}{\sqrt{\sum_{i∈L_{ui}}r_{ui}^2\sum_{j∈L_{vi}}r_{vj}^2}}$

![1542680855031](../../../../../AppData/Roaming/Typora/typora-user-images/1542680855031.png)

单纯利用签到信息产生的推荐不能够完全符合用户的实际信息需求，所以，分析地
点的其他数据信息变得很有必要。

#### 计算地点标签相似度

标签相似度，在本文中指地点的类型相似度。LBSN 中，每个地点都有不同的属性标签，指示该地点属于什么类型，比如艺术馆、运动馆、餐馆等，不同的标签指示该地点具有不同的功能。标签不同于具体的个性化的描述，而是通过一些特征关键词，粗粒度的将事物加以区分，简洁直白的描述全局信息。如表 4-3 给出了 Foursquare 数据集中，某些地点的标签属性

![1542680982324](../../../../../AppData/Roaming/Typora/typora-user-images/1542680982324.png)

表 4-3 中数据显示，一个地点可以有多个标签，假如用户在星巴克签到，他可能是去喝咖啡，也可能是吃早餐；用户在公园签到，有可能是打排球，也有可能是观光风景。实际生活中，用户签到的地点类别也一定程度反映了用户的兴趣爱好，爱好美食的人往往会对不同的美食场所有所青睐，爱好旅游的人则会对不同景点参观游览。因此，能够利用地点的标签挖掘用户爱好有助于提高推荐的质量。

​      计算标签的相似度方法可以以文本相似度理论计算为基础，通过构建向量空间模型（Vector Space Model, VSM）来衡量地点的标签相似度。向量空间模型于上世纪 60 年代末提出，其基本思想是文本所包含的内容与文本中某些特定的语义词语出现的次数有关，但是，与其出现的先后顺序无关。通俗的说，文本中的高频词语可以表达文本的特征。

　　基于 VSM 计算文本的相似度方法是忽略**文本中的文字出现的次序并提取出特征项，计算特征项的权重，通过衡量不同文本之间特征向量的关系来决定文本的相似度**。

　　将 VSM 模型应用到地点标签相似度的计算方法如下：

　　首先，提取地点文本中所有地点的标签词语，每一个标签作为向量空间模型的一个
维度。

　　对于给定的地点 li，将地点的标签作为特征项，构建特征向量：

![1542681571586](../../../../../AppData/Roaming/Typora/typora-user-images/1542681571586.png)



其中 tn 表示地点 li 的一个标签

类比文本中出现次数多的词语对文本的内容影响较大，不同标签对于地点的影响不同，所以需要计算每个标签对地点的影响权重，对应特征向量的权重向量为：

![1542681672101](../../../../../AppData/Roaming/Typora/typora-user-images/1542681672101.png)

这里采用应用最多的权重计算方法词频-逆向文件词频（term frequency - inverse　document frequency，TF-IDF）来计算。计算公式为公式 4-1：

![1542681756766](../../../../../AppData/Roaming/Typora/typora-user-images/1542681756766.png)

公式 4-1 中，TFi,k（term frequency）表示标签在地点 li 出现的频率，计算公式为公式 4-2：

​	![1542682793176](../../../../../AppData/Roaming/Typora/typora-user-images/1542682793176.png)

其中，ni,k 表示标签 k 在地点标签集合中出现的次数，$\sum_{m∈_{l_i}} n_{i,m}$表示地点 li 的标签集合中所有标签出现的次数。

IDFi,k（inverse document frequency）表示标签在所有的地点标签集合中出现的频率，表示该标签的重要程度，计算公式如公式 4-3：

![1542683021652](../../../../../AppData/Roaming/Typora/typora-user-images/1542683021652.png)

其中，|L|表示地点的个数，|{l:ti,k∈l}| 表示包含标签 ti,k 的地点的个数，为防止除数为零的情况出现，改写公式为公式 4-4：

![1542683385362](../../../../../AppData/Roaming/Typora/typora-user-images/1542683385362.png)

得到地点的特征向量，则地点 li 和 lj 之间的相似度可以通过特征向量来计算，采用
余弦相似度的计算方式，如公式 4-5 所示：

![1542683409154](../../../../../AppData/Roaming/Typora/typora-user-images/1542683409154.png)

#### 计算地点距离相似度

LBSN 中，用户与地点发生真实的交互行为。由于地点和传统推荐中的物品最大的区别在于地点本身自带地理位置属性，地点的地理位置的远近对用户的行为有很大的影响。根据生活经验，人们的地点签到信息往往集中于小部分区域，并且，当用户需要位置社交网络提供推荐时，往往会考虑距离近的地方，地点距离越远，用去签到的可能性就越低。所以，计算地点之间的距离，作为地点的距离相似度。

由于用户更偏向于在近的地方进行签到，可以认为，地点之间的距离越远，地点之间的距离相似度越小，反之相似度越大。由于地点与签到成幂律分布，定义地点的距离相似度为公式 4-6：

![1542683760994](../../../../../AppData/Roaming/Typora/typora-user-images/1542683760994.png)

其中，dis(li,lj)表示地点之间球面距离，参考公式 2-5，地点的距离相似度代表地理位置的某种隐性的关

系。

###基于地点的协同过滤推荐算法 PB-CF

基于地点的协同过滤推荐算法的思想是在考虑用户对地点偏好的基础上，重点深入分析地点固有的属性，即距离对推荐的影响，通过融合为用户做出精确的推荐。

无论是地点的签到相似度还是标签相似度，都反映的是地点作为一个普通物品受到用户欢迎的程度，所以，将二者结合形成地点偏好相似度，结合公式以 F 值的公式为基础，综合这二者因素的影响指标，用于综合反映整体的影响，如公式 4-7 所示：

![1542764184790](../../../../../AppData/Roaming/Typora/typora-user-images/1542764184790.png)

地点签到的相似度为$Csim(l_i,l_j)$,$Tsim(l_i,l_j)$是地点标签的的相似度，

在偏好相似度的基础上采用加权系数的方式，根据推荐中的重要程度而赋予不同的权重，具体的融合公式为公式 4-8：

![1542764476060](../../../../../AppData/Roaming/Typora/typora-user-images/1542764476060.png)

其中，参数λ作为调优参数。
最后根据生成的相似度排名进行地点推荐，得到最终的推荐结果

#### PB-CF 算法框架

　　混合地点的多特征因素计算地点的相似度可以弥补传统的基于物品的协同过滤推荐的缺陷。本文从地点的签到记录的相似性、距离相似性和标签相似性出发，改进推荐的效果。
　　本节提出的具体的推荐算法框架如图 4-1 所示。

![1542764567743](../../../../../AppData/Roaming/Typora/typora-user-images/1542764567743.png)





## 融合社交关系和位置影响的地点推荐算法

鉴于好友和地点会对推荐效果产生影响，本文融合这两者提出了地点推荐方法，SL-CF（融合社交关系和位置影响的协同过滤推荐算法，Social and Location CollaborativeFiltering），如图 4-2 表示推荐过程的概念联系示意图，其中用实线箭头表示用户的签到记录，用虚线表示用户的社交关系。

![1542764909947](../../../../../AppData/Roaming/Typora/typora-user-images/1542764909947.png)

#### 计算相似用户

　　协同过滤算法的核心在于相似用户度量，计算相似度[36]的方式有余弦相似度、皮尔逊相关性、欧几里得距离、Jaccard 相似度等。

　　传统的协同过滤算法对于邻居用户的选取主要依赖用户的评分记录，忽略了用户与用户之间隐含的关系，并且地点推荐与普通的物品推荐的不同之处之一在于以用户对地点的签到次数来表示用户的兴趣程度，考虑到地点签到中没有对地点的具体评分，用户之间签到的活跃度各不相同，有些用户会出于隐私考虑只展示部分签到数据，皮尔逊相似度在本算法中并不适用，所以本文工作采用的用户相似度测量方法为 Jaccard 相似度。

　　Jaccard 相似度没有考虑评分的多少，而是根据历史签到的次数决定的相似度。本文利用用户对位置的签到信息，这些位置信息可能会隐含一部分规律，这些规律可以挖掘出用户之间隐藏的信息，从而生更加准确的推荐，采用的计算的公式如公式 4-9 所示：

![1542765923638](../../../../../AppData/Roaming/Typora/typora-user-images/1542765923638.png)

其中：u 和 v 分别表示用户 u 和 v，Lu 和 Lv 分别表示用户 u 和 v 的签到集合。由公式 4-9可知相似用户的计算方法是根据各个用户签到的位置集合来度量，这样做的好处可以体现出位置与位置、人与位置之间的联系。

该相似度的应用体现在：一是找出目标用户的相似用户，二是成为后文中邻居用户的融合因子。因为只有一部分高相似度的用户会融合到邻居用户中，所以对于相似用户的选取一般用两种方式实现：

1）Top-N 过滤；仅保留相似度权重高的用户，但是需要考虑效率以及准确性的问题，N 的选择太大会导致相似用户太多，降低预测的速度。如果 N 的选择太小会使得推荐结果较少，降低推荐的准确性。
2）阈值过滤；这种方法在于相似度值大于一个给定的阈值的结果，保留相似度高的权重，但是关键点在于阈值大小的选取。

#### 计算信任用户

　　Web2.0 时代的协作、交互和信息共享等特征促进了社交网络的发展，随着推荐系统在各领域的应用，人们对信任增强系统产生浓厚兴趣，信任增强推荐系统的两大支柱是推荐技术和信任度，其产生的推荐是基于信任网络的，该网络中用户接受根据信任网络排在较前位置的一些推荐物品，或者甚至是他们信任网中可信朋友的推荐

　　本节的主要内容是信任度的计算。信任度是依据网络上用户间的信任关系来估算一
个用户对另一个用户信任程度的大小。

　　计算信任用户的思想来源于六度分割理论，早期社交网络建立在六度分割理论之上，六度分割理论指出在人际交往的过程中，最多通过六个人就能认识一个新的陌生人，陌生人之间很可能存在某种联系网络中每个人的交际圈会通过朋友的朋友之间的关系不断地扩大重叠。六度分割说明社会中普遍存在着弱关系，弱关系是指和联系不频繁的人的关系，每个人接触最频繁的是自己的亲朋好友，这种关系属于强关系，弱关系在一定程度上可以向好友提供一些原本难以获取的信息[51]。通过弱关系，人与人之间的距离变得非常相近,所以在推荐的过程中，计算信任值并通过信任用户对目标用户产生有效地推荐。

　　根据我们生活中的经验可知，信任是可以传递的，如图 4-3 中给出一个信任传播的示例，现实生活中，A 希望了解一件物品或感兴趣的地点，他通常会参考他朋友 C 的意见，假如朋友 C 不了解此物品，则会问他信任的朋友 E，如此传递。根据信任传播策略，A 在一定程度上是可以信任 E 和 F 的，所以在信任用户选取时，要分别计算用户对朋友，以及朋友的朋友的信任值。

![1542766645910](../../../../../AppData/Roaming/Typora/typora-user-images/1542766645910.png)

在六度分割理论的基础上，人脉反六度分割理论[51]提出：社会中人与人之间的信任存在差异与递减特征。文献[46]中提到，用户首次签到的位置有 30%之多是其朋友或者朋友的朋友已经签到过的。本文改进了传统的信任度的计算方式，对朋友、朋友的朋友采取不同的信任值计算方法。由于路径越短产生的信任估计越准确，所以只考虑信任传播路径长度小于等于 2 的用户。计算方式为公式 4-10：

![1542766834089](../../../../../AppData/Roaming/Typora/typora-user-images/1542766834089.png)

其中，用户 w 是用户 u 的直接好友。Fu、Fv 和 Fw 分别表示用户 u，v，w 的社交朋友圈中好友集合。

#### 融合生成邻居用户

本文改进了传统的基于用户的协同过滤算法，扩大了邻居用户的选取方法。在推荐系统中，为新用户产生恰当的推荐是很难的，因为新用户没有对项目产生评价，无法找到相似用户集合。但是将社交关系中计算出的信任用户包含到邻居用户的选取中，可以扩大邻居用户的选取范围且有助于解决数据稀疏的问题，甚至，在一定程度上缓解冷启动的问题。

在本文提出的 SL-CF 算法中，融合相似度与信任度来作为决策过程中的推荐权重，
融合公式如公式 4-11 所示：

![1542767359873](../../../../../AppData/Roaming/Typora/typora-user-images/1542767359873.png)

其中：SUu 和 TUv 分别表示目标用户 u 的相似用户集合和信任用户集合，α表示权重因子。通过融合后产生新的推荐权重因子 wuv，融合公式 4-11 考虑了只有相似用户、只有信任用户、相似用户与信任用户有并集的三种情况，缓解了可能存在的冷启动问题。

根据推荐权重因子计算对目标用户推荐地点的兴趣概率，参见公式 4-12：

![1542767460225](../../../../../AppData/Roaming/Typora/typora-user-images/1542767460225.png)

其中：Ni(u)表示对地点 i 有访问记录且是用户 u 的邻居用户的集合，由相似用户和信任用户融合而成；
Cv,i 表示用户 v 对地点 i 的签到次数。根据得到的推荐概率，形成预选的推荐列表 L。

#### 地理位置的影响

　　传统的地点推荐方法是：如果我们到某个陌生的地点游玩时，想探索附近的感兴趣的场所，系统往往会按照距离给出一个 Top-N 的推荐列表，但是在查询的过程中，这种地点推荐没有考虑到我们的个人偏好，没有做到个性化的地点推荐。本文提出的基于LBSN 的 SL-CF 推荐算法中，融合相似用户和信任用户产生的推荐，更好地发掘了用户的爱好，通过用户在社交网络的活跃度大大增加了邻居用户的选取范围，基于位置社交网络的推荐需要根据用户的历史签到数据预测用户未来的签到行为，随着其规模的不断扩大，有效地结合地理位置的影响，适应用户的历史签到信息，可以使得地点推荐算法更加个性化。

　　地理学第一定律[53]（Tobler’s First Law of Geography）指出：用户对于位置的访问与用户与位置之间的距离呈现幂律性，幂律分布保证了随着用户与位置之间的距离增大，用户对该位置的签到可能性减小。除此之外，Sarwart 等人[54]指出用户兴趣本地化和活动本地化的特点，表明用户的签到在地理位置上有聚集效应。地理位置会影响用户的行为，为了向用户准确地推荐感兴趣的地点，对预选推荐集的地点列表进行过滤，过滤的依据是位置之间的距离，称之为位置影响。根据此，我们对目标用户的历史签到记录进行分析，相似性表示两个地点之间的相关性，计算公式为公式 4-13：

![1542767790786](../../../../../AppData/Roaming/Typora/typora-user-images/1542767790786.png)

其中：dis(lp,lq)的计算方式为根据地点经纬度计算的欧几里得距离，距离越近，相似度越大。计算出目标用户历史访问地点之间的相关度最小值 Smin 和最大值 Smax，根据相关性对预选推荐表中的地点过滤，生成最终的推荐列表 L'，向用户推荐感兴趣的地点。

####SL-CF 算法框架

本节提出的具体的推荐算法框架如图 4-4 所示，该图可以表示出推荐的并发与合并过程。对于给定的目标用户，分别根据传统的推荐方法计算其相似用户，根据六度分割理论计算信任用户，合并形成邻居用户并产生预选推荐列表，最后通过地点的位置影响对预选推荐列表过滤，产生最后的推荐结果。

![1542768337290](../../../../../AppData/Roaming/Typora/typora-user-images/1542768337290.png)















